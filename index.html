<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>T√≥mbola de Numerolog√≠a Din√°mica</title>
  <style>
    body { font-family: Dubai, Arial, sans-serif; background: linear-gradient(135deg,#2e003e,#6a0dad,#000); color:#fff; text-align:center; margin:0; padding:0; }
    header { padding:20px; background:rgba(0,0,0,0.6); }
    h1 { font-size:2.2em; color:#ffd700; text-shadow:2px 2px 5px #000; }
    .tombola { display:flex; flex-wrap:wrap; justify-content:center; margin:40px auto; max-width:500px; }
    .circle { width:80px; height:80px; border-radius:50%; background:#ffd700; color:#000; display:flex; justify-content:center; align-items:center; font-size:1.5em; font-weight:bold; margin:10px; box-shadow:0 0 10px #000; }
    .contacto { margin:30px auto; padding:20px; background:rgba(255,255,255,0.1); border-radius:10px; width:80%; max-width:600px; }
    a.whatsapp { display:inline-block; margin-top:15px; padding:10px 20px; background:#25D366; color:#fff; text-decoration:none; border-radius:5px; font-weight:bold; }
    a.whatsapp:hover { background:#128C7E; }
    .ranking { margin-top:30px; font-size:1.2em; color:#00ffff; text-shadow:1px 1px 3px #000; }
  </style>
</head>
<body>
  <header>
    <h1>‚ú® T√≥mbola de Numerolog√≠a ‚ú®</h1>
    <p>Los n√∫meros con mayor energ√≠a para ti</p>
  </header>

  <section class="tombola" id="tombola"></section>

  <section class="contacto">
    <h2>√önete a nuestra comunidad</h2>
    <p>Haz clic para acceder al grupo de WhatsApp:</p>
    <a class="whatsapp" href="https://chat.whatsapp.com/BzdiMOPKC9TJLwk1QPDbBx" target="_blank">üëâ Grupo de WhatsApp</a>
  </section>

  <div class="ranking" id="ranking"></div>

  <script>
    let sorteos = [];

    async function cargarSorteos() {
      try {
        // Ajuste clave: usar la ruta absoluta de GitHub Pages
        let res = await fetch("https://avarci3317-source.github.io/numerolog-a-web/resultados.json");
        let data = await res.json();
        sorteos = data;
        analizar();
      } catch (e) {
        document.getElementById("tombola").innerHTML = "<p>Error cargando resultados.</p>";
        console.error("Error:", e);
      }
    }

    function analizar() {
      let hoy = new Date();
      let limite = new Date();
      limite.setDate(hoy.getDate() - 7);

      let conteo = {};
      sorteos.filter(s => new Date(s.fecha) >= limite).forEach(s => {
        s.numeros.forEach(num => {
          conteo[num] = (conteo[num] || 0) + 1;
        });
      });

      if (Object.keys(conteo).length === 0) {
        document.getElementById("tombola").innerHTML = "<p>No hay sorteos en los √∫ltimos 7 d√≠as.</p>";
        return;
      }

      let fuertes = Object.entries(conteo).sort((a,b)=>b[1]-a[1]).slice(0,30).map(x=>parseInt(x[0]));
      let seleccionados = [];
      let copia = [...fuertes];
      while(seleccionados.length<6 && copia.length>0){
        let idx = Math.floor(Math.random()*copia.length);
        seleccionados.push(copia.splice(idx,1)[0]);
      }

      let tombola = document.getElementById("tombola");
      tombola.innerHTML = "";
      seleccionados.forEach(num => {
        let div=document.createElement("div");
        div.className="circle";
        div.textContent=num;
        tombola.appendChild(div);
      });

      let ordenados = Object.entries(conteo).sort((a,b)=>b[1]-a[1]);
      let calientes = ordenados.slice(0,3).map(x=>x[0]+" ("+x[1]+" veces)").join(", ");
      let frios = ordenados.slice(-3).map(x=>x[0]+" ("+x[1]+" veces)").join(", ");
      document.getElementById("ranking").innerHTML =
        "<strong>üî• N√∫meros m√°s calientes:</strong> " + calientes + "<br>" +
        "<strong>‚ùÑÔ∏è N√∫meros m√°s fr√≠os:</strong> " + frios;
    }

    cargarSorteos();
  </script>
</body>
</html>


